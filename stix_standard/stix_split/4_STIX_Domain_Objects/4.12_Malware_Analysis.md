# 4.12 Malware Analysis

**Type Name:** `malware-analysis`

Malware Analysis captures the metadata and results of a particular static or dynamic analysis performed on a malware instance or family. One of `result` or `analysis_sco_refs` properties MUST be provided.

## 4.12.1 Properties

### Required Common Properties
- `type`
- `spec_version`
- `id`
- `created`
- `modified`

### Optional Common Properties
- `created_by_ref`
- `revoked`
- `labels`
- `confidence`
- `lang`
- `external_references`
- `object_marking_refs`
- `granular_markings`
- `extensions`

### Not Applicable Common Properties
- `defanged`

### Malware Analysis Specific Properties
- `product` (required): The name of the analysis engine or product that was used. Product names SHOULD be all lowercase with words separated by a dash "-". For cases where the name of a product cannot be specified, a value of "anonymized" MUST be used.
- `version` (optional): The version of the analysis product that was used to perform the analysis.
- `host_vm_ref` (optional): A description of the virtual machine environment used to host the guest operating system (if applicable) that was used for the dynamic analysis of the malware instance or family. If this value is not included in conjunction with the `operating_system_ref` property, this means that the dynamic analysis may have been performed on bare metal (i.e. without virtualization) or the information was redacted. The value of this property MUST be the `identifier` for a SCO `software` object.
- `operating_system_ref` (optional): The operating system used for the dynamic analysis of the malware instance or family. This applies to virtualized operating systems as well as those running on bare metal. The value of this property MUST be the `identifier` for a SCO `software` object.
- `installed_software_refs` (optional)
- `configuration_version` (optional)
- `modules` (optional)
- `analysis_engine_version` (optional)
- `analysis_definition_version` (optional)
- `submitted` (optional)
- `analysis_started` (optional)
- `analysis_ended` (optional)
- `result_name` (optional)
- `result` (optional)
- `analysis_sco_refs` (optional)
- `sample_ref` (optional)

## 4.12.2 Relationships

These are the relationships explicitly defined between the Malware Analysis object and other STIX Objects. The first section lists the embedded relationships by property name along with their corresponding target. The rest of the table identifies the relationships that can be made from this object type to another object type by way of the Relationship object. The reverse relationships section illustrates the relationships targeting this object type from another object type. They are included here for convenience. For their definitions, please see the "Source" object.

Relationships are not restricted to those listed below. Relationships can be created between any objects using the `related-to` relationship type or, as with open vocabularies, user-defined names.

### Common Relationships
- `duplicate-of`
- `derived-from`
- `related-to`

### Source/Target Relationships
| Source | Relationship Type | Target | Description |
|--------|------------------|---------|-------------|
| malware-analysis | static-analysis-of, dynamic-analysis-of | malware | This Relationship describes that this malware analysis was performed using static or dynamic analysis on the related malware instance or family. | 