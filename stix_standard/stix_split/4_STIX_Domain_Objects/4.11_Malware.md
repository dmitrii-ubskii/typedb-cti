# 4.11 Malware

**Type Name:** `malware`

Malware is a type of TTP that represents malicious code. It generally refers to a program that is inserted into a system, usually covertly. The intent is to compromise the confidentiality, integrity, or availability of the victim's data, applications, or operating system (OS) or otherwise annoy or disrupt the victim.

The Malware SDO characterizes, identifies, and categorizes malware instances and families from data that may be derived from analysis. This SDO captures detailed information about how the malware works and what it does. This SDO captures contextual data relevant to sharing Malware data without requiring the full analysis provided by the Malware Analysis SDO.

The Indicator SDO provides intelligence producers with the ability to define, using the STIX Pattern Grammar in a standard way to identify and detect behaviors associated with malicious activities. Although the Malware SDO provides vital intelligence on a specific instance or malware family, it does not provide a standard grammar that the Indicator SDO provides to identify those properties in security detection systems designed to process the STIX Pattern grammar. We strongly encourage the use of STIX Indicators for the detection of actual malware, due to its use of the STIX Patterning language and the clear semantics that it provides.

To minimize the risk of a consumer compromising their system in parsing malware samples, producers SHOULD consider sharing defanged content (archive and password-protected samples) instead of raw, base64-encoded malware samples.

## 4.11.1 Properties

### Required Common Properties
- `type`
- `spec_version`
- `id`
- `created`
- `modified`

### Optional Common Properties
- `created_by_ref`
- `revoked`
- `labels`
- `confidence`
- `lang`
- `external_references`
- `object_marking_refs`
- `granular_markings`
- `extensions`

### Not Applicable Common Properties
- `defanged`

### Malware Specific Properties
- `name` (optional): A name used to identify the malware instance or family, as specified by the producer of the SDO. For a malware family the name MUST be defined. If a name for a malware instance is not available, the SHA-256 hash value or samples filename MAY be used instead.
- `description` (optional): A description that provides more details and context about the malware instance or family, potentially including its purpose and its key characteristics.
- `malware_types` (optional): A set of categorizations for the malware being described. The values for this property SHOULD come from the `malware-type-ov` open vocabulary.
- `is_family` (required): Whether the object represents a malware family (if `true`) or a malware instance (if `false`).
- `aliases` (optional): Alternative names used to identify this malware or malware family.
- `kill_chain_phases` (optional)
- `first_seen` (optional)
- `last_seen` (optional)
- `operating_system_refs` (optional)
- `architecture_execution_envs` (optional)
- `implementation_languages` (optional)
- `capabilities` (optional)
- `sample_refs` (optional)

## 4.11.2 Relationships

These are the relationships explicitly defined between the Malware object and other STIX Objects. The first section lists the embedded relationships by property name along with their corresponding target. The rest of the table identifies the relationships that can be made from this object type to another object type by way of the Relationship object. The reverse relationships section illustrates the relationships targeting this object type from another object type. They are included here for convenience. For their definitions, please see the "Source" object.

Relationships are not restricted to those listed below. Relationships can be created between any objects using the `related-to` relationship type or, as with open vocabularies, user-defined names.

### Common Relationships
- `duplicate-of`
- `derived-from`
- `related-to`

### Source/Target Relationships
| Source | Relationship Type | Target | Description |
|--------|------------------|---------|-------------|
| malware | authored-by | threat-actor, intrusion-set | This Relationship describes that the malware instance or family was developed by the related threat actor or intrusion set. |
| malware | beacons-to, exfiltrates-to | infrastructure | This Relationship describes that the malware instance or family beacons to or exfiltrates data to the related Infrastructure. |
| malware | communicates-with | ipv4-addr, ipv6-addr, domain-name, url | This Relationship documents that this malware instance (or family) communicates with (beacons to, connects to, or exfiltrated data to) the defined network addressable resource. |
| malware | controls | malware | This Relationship documents that this malware instance (or family) can control other malware which may be resident on the same system on which it is executing. Note that this is not meant to imply or state that the malware instance or family drops other malware (which is covered by the `drops` relationship). Rather, it is meant to state that the malware instance or family is able to subvert or control other malware to achieve its goals. |
| malware | downloads, drops | malware, tool, file | These Relationships document that this malware instance (or family) downloads or drops another malware instance, tool or file. This is especially common with "first-stage" malware instances such as downloaders and droppers. |
| malware | exploits | vulnerability | This Relationship documents that this malware instance or family exploits or attempts to exploit a particular vulnerability. For example, an `exploits` Relationship linking a malware instance or family representing a downloader to a Vulnerability for CVE-2016-0001 means that the malware instance or family exploits that vulnerability. |
| malware | originates-from | location | This Relationship documents that this malware instance or family originates from a particular location. |
| malware | targets | identity, infrastructure, location, vulnerability | This Relationship documents that a malware instance or family is being used to target an Identity, Infrastructure, or Location. For malware families, this can be used to capture the full set of identities, infrastructures, or locations targeted by the family. |

### Examples

```json
{
  "type": "malware",
  "spec_version": "2.1",
  "id": "malware--0c7b5b88-8ff7-4a4d-aa9d-feb398cd0061",
  "created": "2016-05-12T08:17:27.000Z",
  "modified": "2016-05-12T08:17:27.000Z",
  "name": "Cryptolocker",
  "description": "A variant of the cryptolocker family",
  "malware_types": ["ransomware"],
  "is_family": false
}
``` 